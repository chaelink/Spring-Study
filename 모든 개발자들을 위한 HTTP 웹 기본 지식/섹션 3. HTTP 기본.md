# 섹션 3. HTTP 기본

## 1. 모든 것이 HTTP
**HTTP 메시지에 모든 것을 전송**

- HTML, TEXT
- IMAGE, 음성, 영상, 파일
- JSON, XML
- 거의 모든 형태의 데이터 전송 가능
- 서버 간에 데이터를 주고 받을 때도 HTTP 사용


**기반 프로토콜**

- TCP : HTTP1.1, HTTP2
- UDP : HTTP3
- 현재는 HTTP 1.1 을 주로 사용


**HTTP 특징**

- 클라이언트 서버 구조로 동작한다
- 무상태 프로토콜(스테이트리스) 지향, 비연결성
- HTTP 메세지를 통해 통신
- 단순함, 확장 가능



## 2. 클라이언트 서버 구조

- Request Response 구조
- 클라이언트는 서버에 요청을 보내고, 응답 대기
- 서버가 요청에 대한 결과를 만들어서 응답
- +) 클라이언트와 서버의 분리로 독립적으로 진화가 가능하다



## 3. Stateful, Stateless

### 상태 유지 ( Stateful )

• 고객: 이 노트북 얼마인가요?
• 점원: 100만원 입니다. **(노트북 상태 유지)** 

• 고객: 2개 구매하겠습니다.
• 점원: 200만원 입니다. 신용카드, 현금중에 어떤 걸로 구매 하시겠어요?
**(노트북, 2개 상태 유지)** 

• 고객: 신용카드로 구매하겠습니다.
• 점원: 200만원 결제 완료되었습니다. **(노트북, 2개, 신용카드 상태 유지)**

> 중간에 점원이 바뀐다면 장애가 발생한다

### 무상태 프로토콜 ( stateless )

• 고객: 이 노트북 얼마인가요?
• 점원: 100만원 입니다.

• 고객: _노트북_ 2개 구매하겠습니다.
• 점원: 노트북 2개는 200만원 입니다. 신용카드, 현금중에 어떤 걸로 구매 하시겠어요?

• 고객: _노트북 2개를_ 신용카드로 구매하겠습니다.
• 점원: 200만원 결제 완료되었습니다.

> 중간에 점원이 바뀌어도 된다. 갑자기 고객이 증가해도 점원을 대거 투입할 수 있다.

> 클라이언트 요청이 증가하면 서버 증가가 가능하다.

> 응답 서버를 쉽게 바꿀 수 있다 => 무한한 서버 증설 가능

![image](https://github.com/2024-SpringStudy/spring/assets/92051742/3a18e280-e05d-4eb4-8b3f-d29cad3e6368)

**실무 한계**

- 모든 것을 무상태로 설계할 수 있는 경우도 있고 없는 경우도 있다
- 무상태 ( 로그인이 필요 없는 단순 서비스 소개 화면)
- 상태 유지 ( 로그인, 브라우저 쿠키와 서버 세션 등을 사용해서 상태 유지)
- 상태유지는 최소한만 사용한다

**장점 : 서버 확장성이 높다(스케일 아웃)**
**단점 : 클라이언트가 추가 데이터를 전송해야한다**


## 4. 비 연결성

![image](https://github.com/2024-SpringStudy/spring/assets/92051742/bf87ff43-e905-4d49-81e5-3d9379bd66e0)

- 클라이언트1 과 클라이언트 2는 요청을 하지 않고 놀고 있지만 계속 연결이 되어있다.



![image](https://github.com/2024-SpringStudy/spring/assets/92051742/a89e88d6-18a9-4d55-957c-5b41fbde45b2)

- 각 클라이언트는 자신의 요청이 끝나면 연결을 끊는다. 
- 서버가 유지하는 자원을 최소한으로 줄일 수 있다.

### 비 연결성

- HTTP는 기본이 연결을 유지하지 않는 모델
- 일반적으로 초 단위 이하의 빠른 속도로 응답
- 1시간동안 수천명이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이하로 매우 적음
- 서버 자원을 매우 효율적으로 사용 가능

**한계와 극복**

-  일정 시간 후 다음 페이지로 넘어갈 때 TCP/IP 연결을 새로 맺어야 한다. => 3way handshake 시간 소요
- 사이트를 요청할 때 여러 자원이 함께 다운로드 되므로 비효율적
- HTTP 지속 연결로 문제 해결


![image](https://github.com/2024-SpringStudy/spring/assets/92051742/e8ece2f4-6534-4930-b5f8-8d94ad7eade2)

- HTTP 2, 3에서 최적화


> TIP :  최대한 무상태로 설계하자!


## 5. HTTP 메시지

![image](https://github.com/2024-SpringStudy/spring/assets/92051742/ac02412d-95b0-4793-a030-5873ec10a24e)


### 시작 라인 요청 메세지

- **request-line** = http method SP(공백) request-target SP(공백) HTTP-version CRLF(엔터)

![image](https://github.com/2024-SpringStudy/spring/assets/92051742/40719f81-2dc6-4b10-a73d-5e20a1c89d76)

- HTTP 메서드 (GET: 조회)
- 요청 대상 (/search?q=hello&hl=ko)
- HTTP Version


**HTTP 요청 메서드**

- 종류 : GET, POST, PUT, DELETE
- 서버가 수행해야 할 동작 지정


**요청 대상**

- absolute-path[?query] (절대경로[?쿼리])
- 절대경로= "/" 로 시작하는 경로

**HTTP Version**


### 시작 라인 응답 메세지

- **status-line** = HTTP-version SP(공백) status-code SP(공백) reason-phrase CRLF(엔터)

- HTTP 버전
- HTTP 상태 코드: 요청 성공, 실패를 나타냄
    - 200 : 성공
    - 400 : 클라이언트 요청 오류 
    - 500 : 서버 내부 오류
- 이유 문구 : 사람이 이해할 수 있는 짧은 상태 코드 설명 글

 ### HTTP 헤더
 field-name ":" OWS field-value OWS (OWS:띄어쓰기 허용)

![image](https://github.com/2024-SpringStudy/spring/assets/92051742/a07c7930-6c7a-433b-ad75-77723f5b47d6)

**용도**

- HTTP 전송에 필요한 모든 부가정보 ( 바디의 내용, 바디의 크기, 압축, 인증 등)
- 표준 헤더 필드는 매우 많음
- 필요시 임의의 헤더 추가 가능

### HTTP 메세지 바디

- 실제 전송할 데이터
- HTML 문서, 이미지, 영상 등 byte 로 표현할 수 있는 모든 데이터 전송 가능


### HTTP는 매우 단순하며 확장 가능하다. 현재는 HTTP의 시대이다


